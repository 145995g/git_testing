Added a bug fix and modifi
